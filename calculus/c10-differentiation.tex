\documentclass{article}

\usepackage{amsmath,amssymb,amsthm}
\usepackage[shortlabels]{enumitem}

\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\newtheorem*{theorem*}{Theorem}
\newtheorem{lemma}{Lemma}

\begin{document}

\title{Chapter 10: Differentiation}
\maketitle

\begin{theorem}
  If $f$ is a constant function, $f(x) = c$, then \[
    f'(a) = 0 \text{ for all numbers } a.
  \]
\end{theorem}

\begin{theorem}
  If $f$ is the identity function, $f(x) = x$, then \begin{equation*}
    f'(a) = 1 \text{ for all numbers } a.
  \end{equation*}
\end{theorem}

\begin{theorem}
  If $f$ and $g$ are differentiable at $a$, then $f + g$ is also differentiable
  at $a$, and \begin{equation*}
    (f + g)'(a) = f'(a) + g'(a).
  \end{equation*}
\end{theorem}

\begin{theorem}
  If $f$ and $g$ are differentiable at $a$, then \begin{equation*}
    (f \cdot g)'(a) = f'(a) \cdot g(a) + f(a) \cdot g'(a).
  \end{equation*}
\end{theorem}

\begin{theorem}
  If $g(x) = cf(x)$ and $f$ is differentiable at $a$, then $g$ is
  differentiable at $a$, and \begin{equation*}
    g'(a) = c \cdot f'(a).
  \end{equation*}
\end{theorem}

\begin{theorem}
  If $f(x) = x^n$ for some natural number $n$, then \begin{equation*}
    f'(a) = na^{n-1} \text{ for all } a.
  \end{equation*}
\end{theorem}

Now, we move on to more complex theorems.

\begin{theorem}
  If $g$ is differentiable at $a$, and $g(a) \neq 0$, then $1/g$ is
  differentiable at $a$, and \[
    \left(\frac{1}{g}\right)'(a) = \frac{-g'(a)}{[g(a)]^2}.
  \]
\end{theorem}
\begin{proof}
  Before we even write \[
    \frac{\left(\frac{1}{g}\right)(a + h) - \left(\frac{1}{g}\right)(a)}{h}
  \] we must be sure that this expression makes sense - it is necessary to
  check that $(1/g)(a + h)$ is defined for sufficiently small $h$. This
  requires only two observations. Since $g$ is, by hypothesis, differentiable
  at $a$, it follows from Theorem 9-1 that $g$ is continuous at $a$. Since
  $g(a) \neq 0$, it follows from Theorem 6-3 that there is some $\delta > 0$
  such that $g(a + h) \neq 0$ for $|h| < \delta$. Therefore $(1/g)(a + h)$ does
  make sense for small enough $h$, and we can write
  \begin{align*}
    \lim_{h \to 0} \frac{\left( \frac{1}{g} \right)(a + h) - \left( \frac
    {1}{g} \right)(a)}{h}
    &= \lim_{h \to 0} \frac{\frac{1}{g(a + h)} - \frac{1}{g(a)}}{h} \\
    &= \lim_{h \to 0} \frac{g(a) - g(a + h)}{h[g(a) \cdot g(a + h)]} \\
    &= \lim_{h \to 0} \left\{ \frac{-[g(a + h) - g(a)]}{h} \cdot \frac{1}
    {g(a)g(a + h)} \right\} \\
    &= \lim_{h \to 0} \frac{-[g(a + h) - g(a)]}{h} \cdot \lim_{h \to 0}
    \frac{1}{g(a) \cdot g(a + h)} \\
    &= -g'(a) \cdot \frac{1}{[g(a)]^2}
  \end{align*}
  (Notice that we have used continuity of $g$ at $a$ once again.)
\end{proof}

\begin{theorem}
  If $f$ and $g$ are differentiable at $a$ and $g(a) \neq 0$, then $f/g$ is
  differentiable at $a$, and \[
    \left( \frac{f}{g} \right)'(a)
    = \frac{g(a) \cdot f'(a) - f(a) \cdot g'(a)}{[g(a)]^2}.
  \]
\end{theorem}

\begin{theorem}[The Chain rule]
  If $g$ is differentiable at $a$, and $f$ is differentiable at $g(a)$, then $f
  \circ g$ is differentiable at $a$, and \[
    (f \circ g)'(a) = f'(g(a)) \cdot g'(a).
  \]
\end{theorem}
\begin{proof}
  Define a function $\phi$ as follows: \[
    \phi(h) =
    \begin{cases}
      \frac{f(g(a + h)) - f(g(a))}{g(a + h) - g(a)}, &\text{ if } g(a + h) -
      g(a) \neq 0 \\
      f'(g(a)), &\text{ if } g(a + h) - g(a) = 0.
    \end{cases}
  \] It should be intuitively clear that $\phi$ is continuous at 0: When $h$ is
  small, $g(a + h) - g(a)$ is also small, so if $g(a + h) - g(a)$ is not zero,
  then $\phi(h)$ will be close to $f'(g(a))$; and if it is zero, then $\phi(h)$
  actually equals $f'(g(a))$, which is even better. Since the continuity of
  $\phi$ is the crux of the whole proof we will provide a careful translation
  of this intuitive argument.

  We know that $f$ is differentiable at $g(a)$. This means that \[
    \lim_{k \to 0} \frac{f(g(a) + k) - f(g(a))}{k} = f'(g(a)).
  \] Thus, if $\epsilon > 0$ there is some number $\delta' > 0$ such that, for
  all $k$, \[
    \text{(1) if } 0 < |k| < \delta',
    \text{ then } \left| \frac{f(g(a) + k) - f(g(a))}{k} - f'(g(a)) \right|
    < \epsilon.
  \]
  Now $g$ is differentiable at $a$, hence continuous at $a$, so there is a
  $\delta > 0$ such that, for all $h$, \[
    \text{(2) if } |h| < \delta, \text{ then } |g(a + h) - g(a)| < \delta'.
  \] Consider now any $h$ with $|h| < \delta$. If $k = g(a + h) - g(a) \neq 0$,
  then \[
    \phi(h)
    = \frac{f(g(a + h)) - f(g(a))}{g(a + h) - g(a)}
    = \frac{f(g(a) + k) - f(g(a))}{k};
  \] it follows from (2) that $|k| < \delta'$, and hence from (1) that \[
    |\phi(h) - f'(g(a))| < \epsilon.
  \] On the other hand, if $g(a + h) - g(a) = 0$, then $\phi(h) = f'(g(a))$, so
  it is surely true that \[
    |\phi(h) - f'(g(a))| < \epsilon.
    \] We have therefore proven that \[
    \lim_{h \to 0} \phi(h) = f'(g(a)),
  \] so $\phi(h)$ is continuous at 0. The rest of the proof is easy. If $h \neq
  0$, then we have \[
    \frac{f(g(a + h)) - f(g(a))}{h} = \phi(h) \cdot \frac{g(a + h) - g(a)}{h}
  \] even if $g(a + h) - g(a) = 0$ (because in that case both sides are 0).
  Therefore \begin{align*}
    (f \circ g)'(a)
    &= \lim_{h \to 0} \frac{f(g(a + h)) - f(g(a))}{h}
    = \lim_{h \to 0} \phi(h) \cdot \lim_{h \to 0} \frac{g(a + h) - g(a)}{h} \\
    &= f'(g(a)) \cdot g'(a).
  \end{align*}
\end{proof}

\section*{Exercises}

\paragraph{Problem 22}
\begin{enumerate}[(a)]
  \item If $a$ is a double root of $f$, so that $f(x) = (x - a)^2 g(x)$, then
    $f'(x) = 2(x - a)g(x) + (x - a)^2g'(x)$ and so $f(a) = f'(a) = 0$.
    Conversely, if $f(a) = 0$ and $f'(a) = 0$, then $f(x) = (x - a)g(x)$ for
    some $g$ and $f'(x) = (x - a)g'(x) + g(x)$, so $0 = f'(a) = g(a)$; thus
    $g(x) = (x - a)h(x)$ for some $h$, so $f(x) = (x - a)^2h(x)$.
  \item The only root of $0 = f'(x) = 2ax + b$ is $-b/2a$, so $f$ has a double
    root if and only if \[
      0
      = f\left( -\frac{b}{2a} \right)
      = a\left( \frac{b^2}{4a^2} \right) + b\left( -\frac{b}{2a} \right) + c
      = -\frac{b^2}{4a} + c
    \] or $b^2 = 4ac$. Geometrically, this is precisely the condition that the
    graph of $f$ touches the horizontal axis at the single point $-b/2a$.
\end{enumerate}

\paragraph{Problem 24}
\begin{enumerate}[(a)]
  \item Clearly $f$ will have to be the form \[
      f(x) = (ax + b)\prod_{1 \leq j \leq n, j \neq i}{(x - x_j)^2}
    \] with degree $2n - 1$ (as each $x_j$ with $j \neq i$ is a double root by
    Problem 22). It suffices to show that $a$ and $b$ can be picked such that
    $f(x_i) = a_i$ and $f'(x_i) = b_i$.

    If we write $f$ in the form $f(x) = (ax + b)g(x)$, then we must solve
    \begin{align*}
      [g(x_i)x_i] \cdot a + g(x_i) \cdot b &= a_i, \\
      [g'(x_i)x_i + g(x_i)] \cdot a + g'(x_i) \cdot b &= b_i;
    \end{align*}
    these equations can always be solved as \[
      [g(x_i)x_i]g'(x_i) - [g'(x_i)x_i + g(x_i)]g(x_i) = -[g(x_i)]^2 \neq 0.
    \]
  \item Let $f_i$ be the function constructed in (a). Then, let $f = f_1 +
    \ldots + f_n$.
\end{enumerate}

\paragraph{Problem 25}
\begin{enumerate}
  \item If $g(a)$ and $g(b)$ had different signs, then $g(x)$ would be 0 for
    some $x$ in $(a, b)$, which implies that $f(x) = 0$, contradicting the fact
    that $a$ and $b$ are consecutive roots.
  \item We have \[
      f'(x) = (x - a)g(x) + (x - b)g(x) + (x - a)(x - b)g'(x),
    \] so $f'(a) = (a - b)g(a)$, $f'(b) = (b - a)g(b)$. Since $g(a)$ and $g(b)$
    have the same sign, $f'(a)$ and $f'(b)$ have different signs. So $f'(x) =
    0$ for some $x$ in $(a, b)$, since $f'$ is a continuous function.
  \item Let $f(x) = (x - a)^m(x - b)^ng(x)$ where $g(a) \neq 0$ and $g(b) \neq
    0$; then,
    \begin{multline*}
      f'(x) = m(x - a)^{m - 1}(x - b)^ng(x) + n(x - a)^m(x - b)^{n - 1}g(x) \\
      + (x - a)^m(x - b)^ng'(x).
    \end{multline*}
    Consider the polynomial $h(x) = f'(x)/(x - a)^{m - 1}(x - b)^{n - 1}$: \[
      h(x) = m(x - b)g(x) + n(x - a)g(x) + (x - a)(x - b)g'(x),
    \] so
    \begin{align*}
      h(a) &= m(x - b)g(a), \\
      h(b) &= n(b - a)g(b).
    \end{align*}
    Since $m$ and $n$ are positive integers, and $g(a)$ and $g(b)$ are the same
    sign, $h(a)$ and $h(b)$ are of different signs, so $h(x) = 0$ for some $x$
    in $(a, b)$, which implies that $f'(x) = 0$ for some $x$ in $(a, b)$.
\end{enumerate}

\paragraph{Problem 27} Let \[
  g(x) =
  \begin{cases}
    \frac{f(x)}{x}, &x \neq 0; \\
    f'(0), &x = 0.
  \end{cases}
  \] Then $f(x) = xg(x)$ for all $x$, and \[
  g(0) = f'(0) = \lim_{x \to 0} \frac{f(x) - f(0)}{x} = \lim_{x \to 0} g(x),
\] so $g$ is continuous at 0.

\paragraph{Problem 29} Differentiating both sides, \[
  1 = f'(x)g(x) + f(x)g'(x).
\] But there is no solution for $x = 0$; noting that $f(0) = g(0) = 0$, the
right side simplifies to $f'(0)g(0) + f(0)g'(0) = 0 + 0 = 0 \neq 1$. So $f$ and
$g$ are not differentiable at 0.

\paragraph{Problem 31 and 32} The formulas \begin{align*}
  f(x) &= x^m \sin \frac{1}{x}, \\
  f'(x) &= mx^{m - 1} \sin \frac{1}{x} - x^{m - 2} \cos \frac{1}{x}, \\
  f''(x)
  &= m(m - 1)x^{m - 2} \sin \frac{1}{x} - mx^{m - 3} \cos \frac{1}{x} \\
  &- (m - 2)x^{m - 3} \cos \frac{1}{x} + x^{m - 4} \sin \frac{1}{x}, \\
  &= m(m - 1)x^{m - 2} \sin \frac{1}{x} + (2 - 2m)x^{m - 3} \cos \frac{1}{x}
  + x^{m - 4} \sin \frac{1}{x}, \\
  f'''(x) &= m(m - 1)(m - 2)x^{m - 3} \sin \frac{1}{x} - m(m - 1)x^{m - 4}
  \cos \frac{1}{x} \\
  &+ (2 - 2m)(m - 3)x^{m - 4} \cos \frac{1}{x} - (2 - 2m)x^{m - 5}
  \sin \frac{1}{x} \\
  &+ (m - 4)x^{m - 5} \sin \frac{1}{x} - x^{m - 6} \cos \frac{1}{x}
\end{align*}
suggest the following conjecture: If $f(x) = x^m \sin 1/x$, for $x \neq 0$,
then \begin{multline*}
  f^{(k)}(x) = ax^{m-k} \sin \frac{1}{x} \\
  + \sum_{l=k+1}^{2k-1}\left( a_l x^{m - l} \sin \frac{1}{x} + b_l x^{m-l}
  \cos \frac{1}{x} \right) \pm
  \begin{cases}
    x^{m-2k} \sin \frac{1}{x}, &k \text{ even}, \\
    x^{m-2k} \cos \frac{1}{x}, &k \text{ odd}.
  \end{cases}
\end{multline*} for specific numbers $a, a_l, b_l$. Once this conjecture is
made, it is easy to check it by induction. Differentiating the first term
yields \[
  a(m-k)x^{m-k-1} \sin \frac{1}{x} - ax^{m-k-2} \cos \frac{1}{x},
\] and the second half of this expression can be incorporated in the sum
$\sum_{l=k+2}^{2k+1}$ appearing in the desired expression for $f^{(k + 1)}(x)$.
Similarly, differentiating the last term yields \[
  \begin{cases}
    \pm(m - 2k)x^{m - (2k + 1)} \sin \frac{1}{x} \mp x^{m - (2k + 2)}
    \cos \frac{1}{x}, &k \text{ even (} k + 1 \text{ odd)}, \\
    \pm(m - 2k)x^{m - (2k + 1)} \cos \frac{1}{x} \pm x^{m - (2k + 2)}
    \sin \frac{1}{x}, &k \text{ odd (} k + 1 \text{ even)}, \\
  \end{cases}
\] and the first half of each expression can be incorporated in the sum
$\sum_{l=k+2}^{2k+1}$. Finally, each term in the sum $\sum_{l=k+1}^{2k-1}$
yield upon differentiation two terms that can be incorporated in the sum
$\sum_{l=k+2}^{2k+1}$.

It follows, in particular, that if $m = 2n$, then $f^{(k)}(x)$ always has a
factor of at least $x^2$ for $k < n$. So if we define $f(0) = 0$, then \[
  f'(0)
  = \lim_{h \to 0} \frac{f(h) - f(0)}{h}
  = \lim_{h \to 0} \frac{f(h)}{h} = 0;
\] similarly, $f''(0) = \lim_{h \to 0} \frac{f'(h) - f'(0)}{h} = \lim_{h \to 0}
\frac{f'(h)}{h} = 0$, and so on until $f^{(n)}(0) = 0$. On the other hand,
$f^{(n)}(x)$ has the term $\pm \sin{1/x}$ or $\cos{1/x}$ and so $f^{(n)}$ is
not continuous at 0.

On the other hand, for $m = 2n + 1$, $f^{(k)}(x)$ always has a factor of at
least $x^2$ for $k < n$, so $f'(0) = \cdots = f^{(n)}(0) = 0$. But,
$f^{(n)}(x)$ is a sum of terms which do have a factor of at least $x^2$,
together with $\pm x\sin{1/x}$ or $x\cos{1/x}$. It follows that $f^{(n)}$ is
continuous, but not differentiable, at 0.

\end{document}

